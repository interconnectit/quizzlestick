(function(e){var t={quiz:function(t){var n=t;return this.each(function(){var t=e(this),r=n||t.data("quizzlestick"),i,s,o,u,a,f,l,c,h,p,d,v;r=e.extend(true,{},e.fn.quizzlestick.defaults,r);t.data({quizzlestick:r,initialised:true});if(r.id){r.api.send({id:r.id,action:"config"},r)}t.addClass("quizzlestick quizzlestick-"+r.type+" "+r.classname).on("start",r.onstart).on("complete",r.oncomplete).on("answer",r.onanswer).on("correct",r.oncorrect).on("incorrect",r.onincorrect).on("timer",r.ontimer).on("next",r.onnext).on("prev",r.onprev).on("ready",r.onready).on("tap click",".quizzlestick-start",function(e){e.preventDefault();if(t.data("started")||t.data("complete"))return;t.data("started",true);v=setInterval(function(){r.state.time+=1e3;a.html(t.fumanchu("{{templates.timer}}",r));t.trigger("qstimer",[r.state.time,r]);if(r.state.time>=r.timelimit){r.mustanswer=false;t.find(".quizzlestick-finish").click()}else{}},1e3);l.addClass("quizzlestick-hidden").hide();s.show().removeClass("quizzlestick-hidden");t.trigger("qsstart",[v,r])}).on("tap click",".quizzlestick-check",function(n){n.preventDefault();if(t.data("complete")){return}console.log("here");var i=t.find(".quizzlestick-current"),s=i.find(".quizzlestick-answer"),a=i.find(".quizzlestick-result"),f=i.find(".quizzlestick-selected"),l=i.data("id"),v=r.questions[l],m;if(i.data("answered"))return;c.addClass("quizzlestick-hidden").hide();i.addClass("quizzlestick-answered").data("answered",true);r.state.question=l;v.total++;if(!r.state.answers[l])r.state.answers[l]=[];f.each(function(){var n=e(this),i=n.data("id"),s=v.answers[i];r.state.answers[l].push(i);s.total++;n.find(".quizzlestick-answer-total").html(s.total);n.data("total",s.total);if(s.correct){r.state.points+=parseInt(s.points,10);if(r.type!=="which"){n.addClass("quizzlestick-correct");if(s.resultcorrect)a.append(t.fumanchu(s.resultcorrect,s))}}else if(r.type!=="poll"){n.addClass("quizzlestick-incorrect");if(s.resultincorrect)a.append(t.fumanchu(s.resultincorrect,s))}else{n.addClass("quizzlestick-correct");console.log("running a poll?")}});if(r.type==="multi")m=r.state.answers[l].sort().join("")==v.correct.sort().join("");else m=e.grep(v.correct,function(t){return e.inArray(t,r.state.answers[l])>-1}).length;s.each(function(){if(e.inArray(e(this).data("id"),v.correct)>=0&&r.type!=="which"&&r.type!=="poll")e(this).addClass("quizzlestick-correct")});if(r.type==="single"||r.type==="multi"){if(m){i.addClass("quizzlestick-question-correct");if(v.resultcorrect)a.append(t.fumanchu(v.resultcorrect,v,r));else if(v.result)a.append(t.fumanchu(v.result,v,r));a.prepend(t.fumanchu(r.templates.correct,v,r));t.trigger("qscorrect",[m,i,v,r])}else{i.addClass("quizzlestick-question-incorrect");if(v.resultincorrect)a.append(t.fumanchu(v.resultincorrect,v,r));else if(v.result)a.append(t.fumanchu(v.result,v,r));a.prepend(t.fumanchu(r.templates.incorrect,v,r));t.trigger("qsincorrect",[m,i,v,r])}a.append(t.fumanchu(r.templates.nextprev,v,r));h=t.find(".quizzlestick-next").eq(0);p=t.find(".quizzlestick-prev").eq(0);d=t.find(".quizzlestick-finish").eq(0)}else if(r.type==="which"){a.append(t.fumanchu(r.templates.nextprev,v,r));h=t.find(".quizzlestick-next").eq(0);p=t.find(".quizzlestick-prev").eq(0);d=t.find(".quizzlestick-finish").eq(0)}else if(r.type==="poll"){e.each(v.answers,function(e,t){v.answers[e].template=r.templates.pollresult});console.log("poll data results");console.log(v.result);a.append(t.fumanchu(v.result,v,r));a.append(t.fumanchu(r.templates.nextprev,v,r));d=t.find(".quizzlestick-finish").eq(0)}if(e.trim(a.html())!==""&&r.type!=="which"&&r.type!=="poll"){remo;a.removeClass("quizzlestick-hidden")}u.html(t.fumanchu("{{templates.progress}}",r));t.trigger("qsanswer",[m,i,v,r]);r.api.send({id:r.id,action:"answer",question:l,correct:m,state:r.state},r);if(r.helpers.numanswers({},r)>=o.length){if(r.type=="poll"){}if(!r.nextdelay){i.find(".quizzlestick-finish").show().removeClass("quizzlestick-hidden")}else{setTimeout(function(){d.click()},r.nextdelay)}}else{if(!r.nextdelay){if(r.mustanswer&&o.length>1){h.add(i.find(".quizzlestick-next")).show().removeClass("quizzlestick-hidden")}else{}}else{setTimeout(function(){h.click()},r.nextdelay)}}}).on("tap click",".quizzlestick-next",function(e){e.preventDefault();if(t.data("complete"))return;if(r.helpers.numanswers({},r)>=o.length){d.click();return}var n=t.find(".quizzlestick-current"),i=n.next(),s=n.data("id"),a=r.questions[s];o.removeClass("quizzlestick-question-prev quizzlestick-question-next quizzlestick-current");n.removeClass("quizzlestick-current").addClass("quizzlestick-question-prev");if(r.state.question<o.length){r.state.question=s+1;u.html(t.fumanchu("{{templates.progress}}",r));i.addClass("quizzlestick-current").next().addClass("quizzlestick-question-next");t.trigger("qsnext",[i,o,r])}}).on("tap click",".quizzlestick-prev",function(e){e.preventDefault();if(t.data("complete"))return;if(r.helpers.numanswers({},r)>=o.length){d.click();return}var n=t.find(".quizzlestick-current"),i=n.prev(),s="",a=n.data("id"),f=r.questions[a];o.removeClass("quizzlestick-question-prev quizzlestick-question-next quizzlestick-current");n.removeClass("quizzlestick-current quizzlestick-question-prev").addClass("quizzlestick-question-next");if(r.state.question>0){confid.state.question=a-1;u.html(t.fumanchu("{{templates.progress}}",r));i.addClass("quizzlestick-current").prev().addClass("quizzlestick-question-prev");t.trigger("qsprev",[i,o,r])}}).on("tap click",".quizzlestick-answer",function(n){n.preventDefault();if(t.data("complete"))return;var i=e(this),s=e(this).parents(".quizzlestick-question"),u=s.find(".quizzlestick-answer"),a=s.data("id"),f=i.data("id"),l=r.questions[a],h=l.answers[f];if(s.data("answered"))return;o.removeClass("quizzlestick-current quizzlestick-question-next quizzlestick-question-prev");s.addClass("quizzlestick-current");s.next().addClass("quizzlestick-question-next");s.prev().addClass("quizzlestick-question-prev");if(r.type==="multi"){i.toggleClass("quizzlestick-selected");if(u.filter(".quizzlestick-selected").length)c.removeClass("quizzlestick-hidden quizzlestick-disabled");else c.addClass("quizzlestick-disabled")}if(r.type==="single"||r.type==="poll"||r.type==="which"){i.addClass("quizzlestick-selected");c.click()}if(e.type(h.onselect)==="function")h.onselect.apply(this,[h,s,l]);t.trigger("qsselect",[h,s,l,r]);i.trigger("qsselect",[h,s,l,r])}).on("tap click",".quizzlestick-finish",function(n){n.preventDefault();if(t.data("complete"))return;u.html(t.fumanchu("{{templates.progress}}",r));if(r.helpers.numanswers({},r)>=o.length||!r.mustanswer){if(r.timelimit)clearInterval(v);t.addClass("quizzlestick-complete").data("complete",true);t.find(".quizzlestick-next").addClass("quizzlestick-hidden");t.find(".quizzlestick-prev").addClass("quizzlestick-hidden");o.removeClass("quizzlestick-current quizzlestick-question-next");f.html(t.fumanchu("{{templates.result}}",r)).show().removeClass("quizzlestick-hidden");if(r.type=="poll"){pollanswer=r.state.answers[0][0];var i=e(this).parents(".quizzlestick-poll").find(".quizzlestick-poll-results").data("total");e(this).parents(".quizzlestick-poll").find(".quizzlestick-poll-results").data("total",++i);var s=e(this).parents(".quizzlestick-poll").find("#answer-bar-holder-"+pollanswer+" .answer-bar").data("total");e(this).parents(".quizzlestick-poll").find("#answer-bar-holder-"+pollanswer+" .answer-bar").data("total",++s);e(this).parents(".quizzlestick-poll").find(".answer-bar").each(function(){var t=parseInt(100/i*e(this).data("total"));e(this).data("percentagetotal",t).css("width",t+"%");e(this).siblings(".answer-value").html(t+"%")})}r.api.send({id:r.id,action:"complete",state:r.state},r);t.trigger("qscomplete",[r])}});e.each(r.questions,function(t,n){var i=0;n=e.extend(true,{id:t},e.fn.quizzlestick.defaults.questiondefaults,n);if(!n.template&&r.templates.question)n.template=r.templates.question;e.each(n.answers,function(t,s){s=e.extend(true,{id:t},e.fn.quizzlestick.defaults.answerdefaults,s);if(!s.template&&r.templates.answer)s.template=r.templates.answer;if(r.type==="which")s.correct=true;if(r.type==="poll"){s.correct=false;s.points=0}if(s.correct){n.correct.push(t);r.state.poll=false}if(s.correct&&parseInt(s.points,10)<=0&&r.type!=="which")s.points=1;if(r.type==="multi"&&s.correct)r.state.maxpoints+=parseInt(s.points,10);if((r.type==="single"||r.type==="which")&&s.points>i)i=parseInt(s.points,10);n.answers[t]=s});if((r.type==="single"||r.type==="which")&&i)r.state.maxpoints+=parseInt(i,10);r.questions[t]=n});if(r.state.maxpoints>0)r.state.poll=false;if(r.questions){t.html(t.fumanchu(r.templates.scaffold,r));s=t.find(".quizzlestick-questions");o=t.find(".quizzlestick-question");u=t.find(".quizzlestick-progress");a=t.find(".quizzlestick-timer");f=t.find(".quizzlestick-result-final");l=t.find(".quizzlestick-start-screen");c=t.find(".quizzlestick-check").eq(0);h=t.find(".quizzlestick-next").eq(0);p=t.find(".quizzlestick-prev").eq(0);d=t.find(".quizzlestick-finish").eq(0);var m=0,g=0;e.each(r.questions,function(t,n){o.eq(m).attr("data-id",t).data("id",t);if(n.image!=""){o.eq(m).addClass("quizzlestick-image-question")}e.each(n.answers,function(e,t){o.eq(m).find(".quizzlestick-answer").eq(g).attr("data-id",e).data("id",e);if(t.image!=""){o.eq(m).find(".quizzlestick-answer").eq(g).addClass("quizzlestick-image-answer")}g++});g=0;m++});f.hide();if(o.length<2)u.remove();if(parseInt(r.timelimit,10)){s.hide().addClass("quizzlestick-hidden")}else{a.remove();l.remove()}if(r.type!=="multi")t.find(".quizzlestick-check").hide();if(r.type==="which")r.nextdelay=r.nextdelay||500;if(r.mustanswer){t.find(".quizzlestick-next").hide();t.find(".quizzlestick-prev").hide();t.find(".quizzlestick-finish").hide()}o.eq(r.state.question).addClass("quizzlestick-current");o.eq(r.state.question+1).addClass("quizzlestick-question-next")}else{}t.trigger("qsready",[r]);return t})},complete:function(){e(this).find(".quizzlestick-next").eq(-1).click();return this},next:function(){e(this).find(".quizzlestick-question-current .quizzlestick-next").click();return this},prev:function(){e(this).find(".quizzlestick-question-current .quizzlestick-prev").click();return this}};e.fn.quizzlestick=function(n){if(t[n]){return t[n].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof n==="object"||!n){return t.quiz.apply(this,arguments)}else{e.error("Method "+n+" does not exist on jQuery.quizzlestick")}return this};e.fn.quizzlestick.defaults={classname:"",type:"single",id:"",title:"",description:"",timelimit:0,nextdelay:0,state:{question:0,time:0,points:0,maxpoints:0,answers:{},poll:true},mustanswer:true,player:function(){},playonce:false,order:"normal",maxquestions:0,questions:[],results:[],onstart:e.noop,oncomplete:e.noop,onselect:e.noop,onanswer:e.noop,oncorrect:e.noop,onincorrect:e.noop,ontimer:e.noop,onnext:e.noop,onprev:e.noop,onsend:e.noop,onready:e.noop,questiondefaults:{question:"",answers:[],onanswer:null,oncorrect:null,onincorrect:null,result:"",resultcorrect:"",resultincorrect:"",correct:[],total:0,friends:[]},answerdefaults:{answer:"",correct:false,points:0,onselect:null,result:"",resultcorrect:"",resultincorrect:"",total:0,friends:[]},templates:{scaffold:'				<div class="quizzlestick-title">					{{templates.title}}				</div>				<div class="quizzlestick-description">					{{templates.description}}				</div>				<div class="quizzlestick-progress">					{{templates.progress}}				</div>				<div class="quizzlestick-timer">					{{templates.timer}}				</div>				<div class="quizzlestick-start-screen">					{{templates.timerstart}}				</div>				<ol class="quizzlestick-questions">					{{questions}}						<li class="quizzlestick-question">							{{question}}							<ul class="quizzlestick-answers">								{{answers}}									<li class="quizzlestick-answer">										<a href="#">{{answer}}</a>									</li>								{{/answers}}							</ul>							<div class="quizzlestick-result quizzlestick-result-question quizzlestick-hidden"></div>							{{templates.nextprev}}						</li>					{{/questions}}				</ol>				{{templates.toolbar}}				<div class="quizzlestick-result quizzlestick-result-final quizzlestick-hidden">					{{templates.result}}				</div>			',description:"				{{description}}			",title:"				{{title}}			",progress:'				Q: <span class="quizzlestick-current-num">{{helpers.currentquestion}}</span> 				of <span class="quizzlestick-total">{{helpers.numquestions}}</span>			',timer:'				<span class="quizzlestick-timer-time">{{helpers.remainingtime}}</span>				<div class="quizzlestick-timer-progress">					<div class="quizzlestick-timer-progress-bar" style="width:{{helpers.timerwidth}}%;"></div>				</div>			',timerstart:'				<button class="quizzlestick-start" type="button">Start</button>			',result:'				<div class="quizzlestick-result-text">					{{helpers.getresult}}				</div>				{{templates.share}}			',questions:"				{{questions}}			",question:'				<li class="quizzlestick-question">					{{question}}					<ul class="quizzlestick-answers">						{{answers}}							<li class="quizzlestick-answer">								<a href="#">{{answer}}</a>							</li>						{{/answers}}					</ul>					<div class="quizzlestick-result quizzlestick-result-question quizzlestick-hidden"></div>				</li>			',answer:'				<li class="quizzlestick-answer">					<a href="#">{{answer}}</a>				</li>			',pollresults:'				<div class="quizzlestick-poll-results">					{{answers}}				</div>			',pollresult:'				<div class="quizzlestick-poll-result">					{{answer}}					<div class="quizzlestick-poll-result-bar" style="width:{{helpers.answerwidth}}%;"><span>{{total}}</span></div>				</div>			',toolbar:'				<div class="quizzlestick-toolbar">					<a class="quizzlestick-check quizzlestick-hidden" href="#">Check answer</a>				</div>',nextprev:'				<div class="quizzlestick-nextprev">					<a class="quizzlestick-prev quizzlestick-hidden" href="#">Previous</a>					<a class="quizzlestick-next quizzlestick-hidden" href="#">Next</a>					<a class="quizzlestick-finish quizzlestick-hidden" href="#">Results</a>				</div>			',correct:'				<div class="quizzlestick-response-correct">Correct!</div>			',incorrect:'				<div class="quizzlestick-response-incorrect">Wrong!</div>			',share:""},helpers:{time:function(e,t){var n=Math.floor(t.state.time/1e3),r=Math.floor(n/60),i=Math.floor(r/60),s="";n-=r*60;r-=i*60;if(i)s+=(i<10?"0"+i:i)+":";s+=(r<10?"0"+r:r)+":";s+=n<10?"0"+n:n;return s},timerwidth:function(e,t){var n=100/t.timelimit*t.state.time;if(isNaN(n))n=0;return n},remainingtime:function(e,t){var n=Math.floor((t.timelimit-t.state.time)/1e3),r=Math.floor(n/60),i=Math.floor(r/60),s="";n-=r*60;r-=i*60;if(i)s+=(i<10?"0"+i:i)+":";s+=(r<10?"0"+r:r)+":";s+=n<10?"0"+n:n;return s},getresult:function(t,n){if(!e(this).data("complete"))return"";if(e.type(n.results)==="array"){n.results.sort(function(e,t){return parseInt(e.points,10)>parseInt(t.points,10)?1:-1});for(var r in n.results){if(n.state.points<=parseInt(n.results[r].points,10)){return n.results[r]}}}if(e.type(n.results)==="string"){return n.results}return"You scored <strong>{{state.points}}</string> out of <strong>{{state.maxpoints}}</strong>"},getresultimage:function(t,n){var r=e(this).find(".quizzlestick-result-final img"),i=e(this).find(".quizzlestick-result img");if(r.length){return r.eq(-1).attr("src")}else if(i.length){return i.eq(-1).attr("src")}return""},numquestions:function(e,t){return t.helpers.getlength(t.questions)},currentquestion:function(e,t){return parseInt(t.state.question,10)+1},numanswers:function(e,t){var n=0;for(var r in t.state.answers)n++;return n},progresswidth:function(e,t){var n=100/t.helpers.getlength(t.questions)*t.helpers.getlength(t.state.answers);if(isNaN(n))n=0;return n},totalanswers:function(e,t){return e.total},answertotal:function(e,t){return e.total},answerwidth:function(t,n,r){var i=0,s=0;e.map(r.list,function(e,t){return i+=parseInt(e.total,10)});s=100/i*parseInt(t.total,10);if(isNaN(s))s=0;return s},numberformat:function(e){return""+e},getlength:function(t){var n=0;if(e.type(t)==="object"){for(var r in t)if(t.hasOwnProperty(r))n++}else if(t.length){n=t.length}return n}},api:{send:function(e,t){console.log(e);console.log(t)}}};e(document).ready(function(){e("[data-quizzlestick]").quizzlestick()})})(jQuery);(function(e){e.fumanchu=function(t,n,r,i){var s=this;if(!e.fumanchu.regex){e.fumanchu.register("{{","}}");e.fumanchu.register("__",function(e){return escape(e)});e.fumanchu.register("{{round:","}}",function(e){return Math.round(e)});e.fumanchu.register("{{2dp:","}}",function(e){return Number(e).toFixed(2)})}e.fumanchu.context=n||{};e.fumanchu.fallback=r||n;e.fumanchu.args=i||{};if(e.type(t)==="undefined")return"";if(e.type(t)==="function")t=t.apply(s,[e.fumanchu.context,e.fumanchu.fallback,e.fumanchu.args]);if(e.type(t)==="object"){if(t.template){e.fumanchu.context=t;t=t.template}else{try{t=t.html()}catch(o){}}}return t.toString().replace(e.fumanchu.regex,function(t,n,r,o,u,a,f,l){var c=e.fumanchu.getpath(r,e.fumanchu.context,e.fumanchu.fallback),h="",p=a||e.fumanchu.templates[r]||e('[data-template="'+r+'"]').html();if(!e.fumanchu.templates[r]&&p)e.fumanchu.templates[r]=p;if(e.type(c)==="object"&&c.template){h=s.fumanchu(c.template,c,e.fumanchu.fallback,i)}else if(e.type(c)==="array"||e.type(c)==="object"){e.each(c,function(t,n){if(e.type(n)==="object"){if(!n.template&&p)n.template=p;e.fumanchu.context=n}h+=s.fumanchu(n,e.fumanchu.context,e.fumanchu.fallback,{list:c,index:t})})}else if(e.type(c)==="function"){h=c.apply(s,[e.fumanchu.context,e.fumanchu.fallback,i])}else if(e.type(c)==="number"){h=e.fumanchu.numberformat(c,e.fumanchu.fallback)}else if(e.type(c)==="boolean"){h=c?"1":"0"}else if(e.type(c)==="string"){h=c}h=e.fumanchu.delimiters[n].callback(h,c,p);return s.fumanchu(h,e.fumanchu.context,e.fumanchu.fallback,e.fumanchu.args)})};e.fumanchu.getpath=function(n,r,i){n=n.split(".");if(n.length==4&&r&&r[n[0]]&&r[n[0]][n[1]]&&r[n[0]][n[1]][n[2]]&&e.type(r[n[0]][n[1]][n[2]][n[3]])!=="undefined")return r[n[0]][n[1]][n[2]][n[3]];if(n.length==3&&r&&r[n[0]]&&r[n[0]][n[1]]&&e.type(r[n[0]][n[1]][n[2]])!=="undefined")return r[n[0]][n[1]][n[2]];if(n.length==2&&r&&r[n[0]]&&e.type(r[n[0]][n[1]])!=="undefined")return r[n[0]][n[1]];if(n.length==1&&r&&e.type(r[n[0]])!=="undefined")return r[n[0]];if(i&&r!==i){return e.fn.fumanchu.getpath(n.join("."),i)}return""};e.fumanchu.regex=null;e.fumanchu.delimiters={};e.fumanchu.register=function(){if(!arguments||!arguments.length)return;var t=arguments[0],n=false,r=false;if(arguments.length===3){n=arguments[1];r=arguments[2]}else if(arguments.length===2){if(e.type(arguments[1])==="string")n=arguments[1];if(e.type(arguments[1])==="function")r=arguments[1]}if(e.type(t)!=="string")return;if(!n)n=t;if(e.type(r)!=="function")r=function(e){return e};e.fumanchu.delimiters[t]={open:t,close:n,callback:r};e.fumanchu.regex=new RegExp("("+e.map(e.fumanchu.delimiters,function(e,t){return e.open}).join("|")+")([a-z0-9.]+)("+e.map(e.fumanchu.delimiters,function(e,t){return e.close}).join("|")+")((.*?)(?:\\1)/\\2(?:\\3))?","gim")};e.fumanchu.templates={};e.fumanchu.numberformat=function(e,t){return""+e};e(document).ready(function(){e("[data-template]").each(function(){e.fumanchu.templates[e(this).data("template")]=e(this).html()})});e.fn.fumanchu=e.fumanchu})(jQuery)